<div class="content">
  <div class="text-center">
    <h1 class="title">Nueva publicación</h1>
  </div>
  <form id="post" method="post" action="javascript:void(0)" onsubmit="post(); return false;">
    <div class="row justify-content-center">
      <div class="col-md-4">
        <div class="form-group">
          <label>Título</label>
          <input name="title" class="form-control" type="text" required>
        </div>
        <div class="form-group">
          <label>Descripción</label>
          <textarea name="brief" class="form-control" style="height: 5em;" required></textarea>
        </div>
        <div class="form-group">
          <label>Tags</label>
          <input name="tags" class="form-control" type="text" required>
          <small>Separados por comas</small>
        </div>
        <div class="form-group">
          <label><input type="checkbox" class="checkbox" required> He leído y acepto las <a href="#">normas de la comunidad</a>.</label>
        </div>
        <div class="text-center">
          <button class="btn btn-primary">Publicar</button>
        </div>
        <div class="text-center">
          <a href="javascript:void(0)" onclick="preview()" class="btn btn-default">Previsualizar</a>
        </div>
      </div>
      <div class="col-md-6">
        <div class="form-group">
          <label>Contenido</label>
          <textarea name="content" class="form-control content-editor" required></textarea>
        </div>
      </div>
    </div>
  </form>
</div>
<script>
  function post() {
    var form = document.getElementById('post')
    $.post('/post', {
      title: form.title.value,
      brief: form.brief.value,
      content: form.content.value,
      tags: form.tags.value.split(', ').map(e => $.trim(e))
    }, function (data) {
      data = JSON.parse(data)
      console.log(data)
    })
  }
  
  function preview() {
    var form = document.getElementById('post')
    var w = window.open(`/preview?title=${form.title.value}&brief=${form.brief.value}&content=${form.content.value}`, '_blank')
    w.focus()
  }
</script>